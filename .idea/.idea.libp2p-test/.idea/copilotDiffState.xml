<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/libp2p-test/Program.cs">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/libp2p-test/Program.cs" />
              <option name="originalContent" value="using System.Text.RegularExpressions;&#10;using Microsoft.Extensions.DependencyInjection;&#10;using Microsoft.Extensions.Logging;&#10;using Nethermind.Libp2p;&#10;&#10;namespace libp2p_test;&#10;&#10;internal class Program&#10;{&#10;    private static async Task Main(string[] args)&#10;    {&#10;        Console.Write(&quot;Nickname: &quot;);&#10;        var nickName = Console.ReadLine();&#10;&#10;        Regex omittedLogs = new(&quot;.*(MDnsDiscoveryProtocol|IpTcpProtocol).*&quot;);&#10;&#10;        var headless = args.Contains(&quot;--headless&quot;);&#10;&#10;        var services = new ServiceCollection()&#10;            .AddLibp2p(builder =&gt; builder.WithPubsub())&#10;            .AddLogging(builder =&gt;&#10;            {&#10;                builder.SetMinimumLevel(args.Contains(&quot;--trace&quot;) ? LogLevel.Trace : LogLevel.Information)&#10;                    .AddFilter((_, type, lvl) =&gt; !omittedLogs.IsMatch(type!));&#10;&#10;                if (headless)&#10;                    builder.AddSimpleConsole(l =&gt;&#10;                    {&#10;                        l.SingleLine = true;&#10;                        l.TimestampFormat = &quot;[HH:mm:ss.fff]&quot;;&#10;                    });&#10;            })&#10;            .BuildServiceProvider();&#10;&#10;        var chatService = new ChatService(services);&#10;        await chatService.StartAsync();&#10;&#10;        // Start a background printer task that periodically prints new incoming messages&#10;        using var printCts = new CancellationTokenSource();&#10;        var printTask = Task.Run(async () =&gt;&#10;        {&#10;            int lastPrinted = 0;&#10;            try&#10;            {&#10;                while (!printCts.Token.IsCancellationRequested)&#10;                {&#10;                    var msgs = chatService.Messages;&#10;                    for (int i = lastPrinted; i &lt; msgs.Count; i++)&#10;                    {&#10;                        Console.WriteLine(msgs[i]);&#10;                    }&#10;                    lastPrinted = msgs.Count;&#10;                    await Task.Delay(200, printCts.Token);&#10;                }&#10;            }&#10;            catch (OperationCanceledException) { }&#10;        }, printCts.Token);&#10;&#10;        while (true)&#10;        {&#10;            var msg = Console.ReadLine();&#10;&#10;            if (string.IsNullOrWhiteSpace(msg))&#10;                continue;&#10;&#10;            if (msg == &quot;exit&quot;)&#10;                break;&#10;&#10;            chatService.Publish(msg, nickName);&#10;        }&#10;&#10;        // Stop background printer and chat service&#10;        printCts.Cancel();&#10;        await printTask;&#10;&#10;        chatService.Stop();&#10;    }&#10;}" />
              <option name="updatedContent" value="using System.Text.RegularExpressions;&#10;using Microsoft.Extensions.DependencyInjection;&#10;using Microsoft.Extensions.Logging;&#10;using Nethermind.Libp2p;&#10;&#10;namespace libp2p_test;&#10;&#10;internal class Program&#10;{&#10;    private static async Task Main(string[] args)&#10;    {&#10;        Console.Write(&quot;Nickname: &quot;);&#10;        var nickName = Console.ReadLine();&#10;&#10;        Regex omittedLogs = new(&quot;.*(MDnsDiscoveryProtocol|IpTcpProtocol).*&quot;);&#10;&#10;        var headless = args.Contains(&quot;--headless&quot;);&#10;&#10;        var services = new ServiceCollection()&#10;            .AddLibp2p(builder =&gt; builder.WithPubsub())&#10;            .AddLogging(builder =&gt;&#10;            {&#10;                builder.SetMinimumLevel(args.Contains(&quot;--trace&quot;) ? LogLevel.Trace : LogLevel.Information)&#10;                    .AddFilter((_, type, lvl) =&gt; !omittedLogs.IsMatch(type!));&#10;&#10;                if (headless)&#10;                    builder.AddSimpleConsole(l =&gt;&#10;                    {&#10;                        l.SingleLine = true;&#10;                        l.TimestampFormat = &quot;[HH:mm:ss.fff]&quot;;&#10;                    });&#10;            })&#10;            .BuildServiceProvider();&#10;&#10;        var chatService = new ChatService(services);&#10;        await chatService.StartAsync();&#10;&#10;        // Start a background printer task that periodically prints new incoming messages&#10;        using var printCts = new CancellationTokenSource();&#10;        var printTask = Task.Run(async () =&gt;&#10;        {&#10;            int lastPrinted = 0;&#10;            try&#10;            {&#10;                while (!printCts.Token.IsCancellationRequested)&#10;                {&#10;                    var msgs = chatService.Messages;&#10;                    for (int i = lastPrinted; i &lt; msgs.Count; i++)&#10;                    {&#10;                        Console.WriteLine(msgs[i]);&#10;                    }&#10;                    lastPrinted = msgs.Count;&#10;                    await Task.Delay(200, printCts.Token);&#10;                }&#10;            }&#10;            catch (OperationCanceledException) { }&#10;        }, printCts.Token);&#10;&#10;        while (true)&#10;        {&#10;            var msg = Console.ReadLine();&#10;&#10;            if (string.IsNullOrWhiteSpace(msg))&#10;                continue;&#10;&#10;            if (msg == &quot;exit&quot;)&#10;                break;&#10;&#10;            chatService.Publish(msg, nickName);&#10;        }&#10;&#10;        // Stop background printer and chat service&#10;        printCts.Cancel();&#10;        await printTask;&#10;&#10;        chatService.Stop();&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>